{"id":"da3bac9f-ca05-4ec0-8abe-65c790b51b29","revision":0,"last_node_id":92,"last_link_id":149,"nodes":[{"id":58,"type":"SaveAnimatedWEBP","pos":[469.135986328125,188.9629364013672],"size":[670,780],"flags":{},"order":32,"mode":4,"inputs":[{"localized_name":"图片","name":"images","type":"IMAGE","link":117},{"localized_name":"文件名前缀","name":"filename_prefix","type":"STRING","widget":{"name":"filename_prefix"},"link":null},{"localized_name":"帧率","name":"fps","type":"FLOAT","widget":{"name":"fps"},"link":null},{"localized_name":"无损","name":"lossless","type":"BOOLEAN","widget":{"name":"lossless"},"link":null},{"localized_name":"质量","name":"quality","type":"INT","widget":{"name":"quality"},"link":null},{"localized_name":"方法","name":"method","type":"COMBO","widget":{"name":"method"},"link":null}],"outputs":[],"properties":{"cnr_id":"comfy-core","ver":"0.3.34","Node name for S&R":"SaveAnimatedWEBP","widget_ue_connectable":{}},"widgets_values":["ComfyUI",6,true,80,"default"]},{"id":60,"type":"TrimVideoLatent","pos":[-1002.1471557617188,509.32275390625],"size":[276.5860290527344,58],"flags":{"collapsed":false},"order":30,"mode":0,"inputs":[{"localized_name":"samples","name":"samples","type":"LATENT","link":119},{"localized_name":"trim_amount","name":"trim_amount","type":"INT","widget":{"name":"trim_amount"},"link":120}],"outputs":[{"localized_name":"Latent","name":"LATENT","type":"LATENT","links":[121]}],"properties":{"cnr_id":"comfy-core","ver":"0.3.34","Node name for S&R":"TrimVideoLatent","widget_ue_connectable":{"trim_amount":true}},"widgets_values":[0]},{"id":61,"type":"MarkdownNote","pos":[-1020.9765014648438,814.8538208007812],"size":[270.8102111816406,186.98114013671875],"flags":{},"order":0,"mode":0,"inputs":[],"outputs":[],"properties":{"widget_ue_connectable":{}},"widgets_values":["You can replace this part with another image preprocessor. \n\nRelated custom node: \n[comfyui_controlnet_aux](https://github.com/Fannovel16/comfyui_controlnet_aux)\n\n可以把这部分替换成其它的图像预处理器\n"],"color":"#432","bgcolor":"#653"},{"id":62,"type":"VAEDecode","pos":[-607.685302734375,524.9351196289062],"size":[210,46],"flags":{"collapsed":false},"order":31,"mode":0,"inputs":[{"localized_name":"Latent","name":"samples","type":"LATENT","link":121},{"localized_name":"vae","name":"vae","type":"VAE","link":122}],"outputs":[{"localized_name":"图像","name":"IMAGE","type":"IMAGE","slot_index":0,"links":[117,131]}],"properties":{"cnr_id":"comfy-core","ver":"0.3.34","Node name for S&R":"VAEDecode","widget_ue_connectable":{}},"widgets_values":[]},{"id":63,"type":"Any Switch (rgthree)","pos":[-1927.721435546875,-102.04715728759766],"size":[250.08045959472656,106],"flags":{"collapsed":true},"order":17,"mode":0,"inputs":[{"dir":3,"name":"any_01","type":"MODEL","link":123},{"dir":3,"name":"any_02","type":"MODEL","link":124},{"dir":3,"name":"any_03","type":"MODEL","link":null},{"dir":3,"name":"any_04","type":"MODEL","link":null},{"dir":3,"name":"any_05","type":"MODEL","link":null}],"outputs":[{"dir":4,"label":"MODEL","name":"*","shape":3,"type":"MODEL","links":[127]}],"title":"Model switch","properties":{"cnr_id":"rgthree-comfy","ver":"aa6c75a30b3ee8f01d7c9f8b0a126cccdc90616a","widget_ue_connectable":{}},"widgets_values":[]},{"id":65,"type":"CLIPLoader","pos":[-1885.3958740234375,366.9123229980469],"size":[270,106],"flags":{},"order":1,"mode":4,"inputs":[{"localized_name":"CLIP名称","name":"clip_name","type":"COMBO","widget":{"name":"clip_name"},"link":null},{"localized_name":"类型","name":"type","type":"COMBO","widget":{"name":"type"},"link":null},{"localized_name":"设备","name":"device","shape":7,"type":"COMBO","widget":{"name":"device"},"link":null}],"outputs":[{"localized_name":"CLIP","name":"CLIP","type":"CLIP","links":[]}],"properties":{"cnr_id":"comfy-core","ver":"0.3.32","Node name for S&R":"CLIPLoader","widget_ue_connectable":{}},"widgets_values":["t5xxl_fp8_e4m3fn.safetensors","wan","default"]},{"id":67,"type":"VAELoader","pos":[-1919.0147705078125,494.3399353027344],"size":[390,60],"flags":{},"order":2,"mode":0,"inputs":[{"localized_name":"vae名称","name":"vae_name","type":"COMBO","widget":{"name":"vae_name"},"link":null}],"outputs":[{"localized_name":"VAE","name":"VAE","type":"VAE","slot_index":0,"links":[122,134]}],"properties":{"cnr_id":"comfy-core","ver":"0.3.34","Node name for S&R":"VAELoader","models":[{"name":"wan_2.1_vae.safetensors","url":"https://huggingface.co/Comfy-Org/Wan_2.1_ComfyUI_repackaged/resolve/main/split_files/vae/wan_2.1_vae.safetensors","hash":"2fc39d31359a4b0a64f55876d8ff7fa8d780956ae2cb13463b0223e15148976b","hash_type":"SHA256","directory":"vae"}],"widget_ue_connectable":{}},"widgets_values":["wan_2.1_vae.safetensors"]},{"id":68,"type":"Note","pos":[-1480.3656005859375,-268.681884765625],"size":[250.90176391601562,88],"flags":{},"order":3,"mode":0,"inputs":[],"outputs":[],"properties":{},"widgets_values":["Feel free to enabled those two Optimizations if you have updated torch, and for the one on the left sage attention installed."],"color":"#432","bgcolor":"#653"},{"id":69,"type":"ModelPatchTorchSettings","pos":[-1517.718017578125,-133.0425567626953],"size":[307.443359375,58],"flags":{},"order":21,"mode":4,"inputs":[{"localized_name":"model","name":"model","type":"MODEL","link":126},{"localized_name":"enable_fp16_accumulation","name":"enable_fp16_accumulation","type":"BOOLEAN","widget":{"name":"enable_fp16_accumulation"},"link":null}],"outputs":[{"localized_name":"模型","name":"MODEL","type":"MODEL","links":[147]}],"properties":{"cnr_id":"comfyui-kjnodes","ver":"5dcda71011870278c35d92ff77a677ed2e538f2d","Node name for S&R":"ModelPatchTorchSettings","widget_ue_connectable":{}},"widgets_values":[true]},{"id":71,"type":"MarkdownNote","pos":[-2493.16650390625,-17.708965301513672],"size":[555.9662475585938,458.7068786621094],"flags":{},"order":4,"mode":0,"inputs":[],"outputs":[],"properties":{"widget_ue_connectable":{}},"widgets_values":["[Tutorial](https://docs.comfy.org/tutorials/video/wan/vace) | [教程](https://docs.comfy.org/zh-CN/tutorials/video/wan/vace)\n\n\n**diffusion_models** \n\n- [Wan2.1-VACE-14B-GGUF](https://huggingface.co/QuantStack/Wan2.1-VACE-14B-GGUF)\n\n**VAE**\n- [wan_2.1_vae.safetensors](https://huggingface.co/Comfy-Org/Wan_2.1_ComfyUI_repackaged/resolve/main/split_files/vae/wan_2.1_vae.safetensors?download=true)\n\n**Text encoders**   Chose one of following model\n- [umt5_xxl_fp16.safetensors](https://huggingface.co/Comfy-Org/Wan_2.1_ComfyUI_repackaged/resolve/main/split_files/text_encoders/umt5_xxl_fp16.safetensors?download=true)\n- [umt5_xxl_fp8_e4m3fn_scaled.safetensors](https://huggingface.co/Comfy-Org/Wan_2.1_ComfyUI_repackaged/resolve/main/split_files/text_encoders/umt5_xxl_fp8_e4m3fn_scaled.safetensors?download=true)\n- [umt5-xxl-encoder-gguf](https://huggingface.co/city96/umt5-xxl-encoder-gguf/tree/main)\n\n> You can choose between fp16, fp8 and ggufs.\n\n**CausVidLora(Optional for a lot more speed)**\n- [Wan21_CausVid_14B_T2V_lora_rank32.safetensors](https://huggingface.co/Kijai/WanVideo_comfy/resolve/main/Wan21_CausVid_14B_T2V_lora_rank32.safetensors?download=true)\n\n\n\nFile save location\n\n```\nComfyUI/\n├── models/\n│   ├── loras/\n│   │   └─── Wan21_CausVid_14B_T2V_lora_rank32.safetensors\n│   ├── unet/\n│   │   └─── Wan2.1-VACE-14B-Qx_x_x.gguf\n│   ├── text_encoders/\n│   │   └─── umt5_xxl_fp8_e4m3fn_scaled.safetensors # or GGUF (umt5-xxl-encoder-Qx_x.gguf)\n│   └── vae/\n│       └──  wan_2.1_vae.safetensors\n\n```\n"],"color":"#432","bgcolor":"#653"},{"id":72,"type":"Note","pos":[-711.66796875,-142.97357177734375],"size":[347.763427734375,108.60783386230469],"flags":{},"order":5,"mode":0,"inputs":[],"outputs":[],"properties":{},"widgets_values":["If you want to speed up your generation by 5x or more, use the causvid lora in the lora loader. If you enable this, you can set the steps to around 4-6 and have to set cfg to 1. \nThat way it can generate a good looking output video in a lot less time."],"color":"#432","bgcolor":"#653"},{"id":73,"type":"Note","pos":[-1029.9212646484375,-111.17106628417969],"size":[210,88],"flags":{},"order":6,"mode":0,"inputs":[],"outputs":[],"properties":{},"widgets_values":["Test around with the shift value to get your prefered resutls, you can also disable it."],"color":"#432","bgcolor":"#653"},{"id":74,"type":"Note","pos":[-1600.288330078125,1040.1724853515625],"size":[549.1627197265625,102.93431091308594],"flags":{},"order":7,"mode":0,"inputs":[],"outputs":[],"properties":{},"widgets_values":["Make sure to use roughly the same frame amount and framerate for your input video, as you do for the generation. \n\nAlso make sure to set width and  height in this node, otherwise you might run into ooms with the canny node. If you replace that part feel free to change this though."],"color":"#432","bgcolor":"#653"},{"id":75,"type":"CLIPTextEncode","pos":[-1495.7913818359375,357.884033203125],"size":[425.27801513671875,180.6060791015625],"flags":{},"order":26,"mode":0,"inputs":[{"localized_name":"clip","name":"clip","type":"CLIP","link":128},{"localized_name":"文本","name":"text","type":"STRING","widget":{"name":"text"},"link":null}],"outputs":[{"localized_name":"条件","name":"CONDITIONING","type":"CONDITIONING","slot_index":0,"links":[133]}],"title":"CLIP Text Encode (Negative Prompt)","properties":{"cnr_id":"comfy-core","ver":"0.3.34","Node name for S&R":"CLIPTextEncode","widget_ue_connectable":{}},"widgets_values":[""],"color":"#322","bgcolor":"#533"},{"id":78,"type":"Note","pos":[-1510.3819580078125,-48.05091857910156],"size":[440,100],"flags":{},"order":8,"mode":0,"inputs":[],"outputs":[],"properties":{"widget_ue_connectable":{}},"widgets_values":["Since umt5 is a variant based on T5, the input of prompt supports multiple languages.\n\n---\n\n由于 umt5 是基于 T5 的变体，所以提示词输入是支持多种语言输入的"],"color":"#432","bgcolor":"#653"},{"id":80,"type":"VHS_VideoCombine","pos":[-283.1990966796875,163.42041015625],"size":[691.6607055664062,1534.6005859375],"flags":{},"order":33,"mode":0,"inputs":[{"localized_name":"images","name":"images","type":"IMAGE","link":131},{"localized_name":"audio","name":"audio","shape":7,"type":"AUDIO","link":null},{"localized_name":"meta_batch","name":"meta_batch","shape":7,"type":"VHS_BatchManager","link":null},{"localized_name":"vae","name":"vae","shape":7,"type":"VAE","link":null},{"localized_name":"frame_rate","name":"frame_rate","type":"FLOAT","widget":{"name":"frame_rate"},"link":null},{"localized_name":"loop_count","name":"loop_count","type":"INT","widget":{"name":"loop_count"},"link":null},{"localized_name":"filename_prefix","name":"filename_prefix","type":"STRING","widget":{"name":"filename_prefix"},"link":null},{"localized_name":"format","name":"format","type":"COMBO","widget":{"name":"format"},"link":null},{"localized_name":"pingpong","name":"pingpong","type":"BOOLEAN","widget":{"name":"pingpong"},"link":null},{"localized_name":"save_output","name":"save_output","type":"BOOLEAN","widget":{"name":"save_output"},"link":null}],"outputs":[{"localized_name":"Filenames","name":"Filenames","type":"VHS_FILENAMES","links":[143]}],"properties":{"cnr_id":"comfyui-videohelpersuite","ver":"1.6.1","Node name for S&R":"VHS_VideoCombine","widget_ue_connectable":{}},"widgets_values":{"frame_rate":14,"loop_count":0,"filename_prefix":"vace_14b","format":"video/nvenc_h264-mp4","pix_fmt":"yuv420p","bitrate":10,"megabit":true,"save_metadata":true,"pingpong":false,"save_output":true,"videopreview":{"hidden":false,"paused":false,"params":{"filename":"vace_14b_00003.mp4","subfolder":"","type":"output","format":"video/nvenc_h264-mp4","frame_rate":14,"workflow":"vace_14b_00003.png","fullpath":"D:\\AI\\ComfyUI\\output\\vace_14b_00003.mp4"}}}},{"id":87,"type":"easy cleanGpuUsed","pos":[398.3106689453125,-30.414104461669922],"size":[210,26],"flags":{},"order":34,"mode":0,"inputs":[{"localized_name":"输入任何","name":"anything","type":"*","link":143}],"outputs":[{"localized_name":"output","name":"output","type":"*","links":[]}],"properties":{"cnr_id":"comfyui-easy-use","ver":"1.2.9","Node name for S&R":"easy cleanGpuUsed"},"widgets_values":[]},{"id":88,"type":"easy cleanGpuUsed","pos":[-1575.9759521484375,241.0580596923828],"size":[210,26],"flags":{},"order":24,"mode":0,"inputs":[{"localized_name":"输入任何","name":"anything","type":"*","link":144}],"outputs":[{"localized_name":"output","name":"output","type":"*","links":[128]}],"properties":{"cnr_id":"comfyui-easy-use","ver":"1.2.9","Node name for S&R":"easy cleanGpuUsed"},"widgets_values":[]},{"id":89,"type":"easy cleanGpuUsed","pos":[-1506.850341796875,88.78734588623047],"size":[210,26],"flags":{},"order":25,"mode":0,"inputs":[{"localized_name":"输入任何","name":"anything","type":"*","link":145}],"outputs":[{"localized_name":"output","name":"output","type":"*","links":[146]}],"properties":{"cnr_id":"comfyui-easy-use","ver":"1.2.9","Node name for S&R":"easy cleanGpuUsed"},"widgets_values":[]},{"id":77,"type":"Note","pos":[-1919.5714111328125,-385.0609130859375],"size":[250.90176391601562,147.25364685058594],"flags":{},"order":9,"mode":0,"inputs":[],"outputs":[],"properties":{},"widgets_values":["IF you have 32gb but only 12/16gb or even less vram, you might want to use the \"Low Vram high ram\" loader to offload parts of the model to prevent out of memory errors. You can use this on any card, it can be useful even on a 4090, though be careful with only 16gb ram, you might need to change the virtual vram gb to less."],"color":"#432","bgcolor":"#653"},{"id":82,"type":"Fast Groups Bypasser (rgthree)","pos":[-1920.9578857421875,-505.5936584472656],"size":[252.24124145507812,82],"flags":{},"order":10,"mode":0,"inputs":[],"outputs":[{"name":"OPT_CONNECTION","type":"*","links":null}],"properties":{"matchColors":"purple","matchTitle":"","showNav":true,"sort":"position","customSortAlphabet":"","toggleRestriction":"max one","widget_ue_connectable":{}},"color":"#323","bgcolor":"#535"},{"id":66,"type":"ClipLoaderGGUF","pos":[-1893.1234130859375,221.08328247070312],"size":[270,106],"flags":{},"order":11,"mode":0,"inputs":[{"localized_name":"clip_name","name":"clip_name","type":"COMBO","widget":{"name":"clip_name"},"link":null},{"localized_name":"type","name":"type","type":"COMBO","widget":{"name":"type"},"link":null},{"localized_name":"device","name":"device","shape":7,"type":"COMBO","widget":{"name":"device"},"link":null}],"outputs":[{"localized_name":"CLIP","name":"CLIP","type":"CLIP","links":[148]}],"properties":{"cnr_id":"gguf","ver":"556ffba1a1dff3f5e1d1ad65c3103839883a824c","Node name for S&R":"ClipLoaderGGUF","widget_ue_connectable":{}},"widgets_values":["umt5-xxl-encoder-Q8_0.gguf","wan","cpu"]},{"id":79,"type":"ModelSamplingSD3","pos":[-1027.50830078125,15.178163528442383],"size":[210,58],"flags":{},"order":23,"mode":0,"inputs":[{"localized_name":"模型","name":"model","type":"MODEL","link":130},{"localized_name":"移位","name":"shift","type":"FLOAT","widget":{"name":"shift"},"link":null}],"outputs":[{"localized_name":"模型","name":"MODEL","type":"MODEL","slot_index":0,"links":[139]}],"properties":{"cnr_id":"comfy-core","ver":"0.3.34","Node name for S&R":"ModelSamplingSD3","widget_ue_connectable":{}},"widgets_values":[8.000000000000002]},{"id":76,"type":"PreviewImage","pos":[-735.9075927734375,759.3674926757812],"size":[409.20550537109375,246],"flags":{"collapsed":false},"order":20,"mode":4,"inputs":[{"localized_name":"图像","name":"images","type":"IMAGE","link":129}],"outputs":[],"properties":{"cnr_id":"comfy-core","ver":"0.3.34","Node name for S&R":"PreviewImage","widget_ue_connectable":{}},"widgets_values":[]},{"id":86,"type":"KSampler","pos":[-665.7283935546875,164.8548583984375],"size":[362.2787170410156,618.2786865234375],"flags":{},"order":29,"mode":0,"inputs":[{"localized_name":"模型","name":"model","type":"MODEL","link":139},{"localized_name":"正面条件","name":"positive","type":"CONDITIONING","link":140},{"localized_name":"负面条件","name":"negative","type":"CONDITIONING","link":141},{"localized_name":"Latent图像","name":"latent_image","type":"LATENT","link":142},{"localized_name":"种子","name":"seed","type":"INT","widget":{"name":"seed"},"link":null},{"localized_name":"步数","name":"steps","type":"INT","widget":{"name":"steps"},"link":null},{"localized_name":"cfg","name":"cfg","type":"FLOAT","widget":{"name":"cfg"},"link":null},{"localized_name":"采样器名称","name":"sampler_name","type":"COMBO","widget":{"name":"sampler_name"},"link":null},{"localized_name":"调度器","name":"scheduler","type":"COMBO","widget":{"name":"scheduler"},"link":null},{"localized_name":"降噪","name":"denoise","type":"FLOAT","widget":{"name":"denoise"},"link":null}],"outputs":[{"localized_name":"Latent","name":"LATENT","type":"LATENT","slot_index":0,"links":[119]}],"properties":{"cnr_id":"comfy-core","ver":"0.3.34","Node name for S&R":"KSampler","widget_ue_connectable":{}},"widgets_values":[234177018767991,"randomize",5,1,"uni_pc","normal",1]},{"id":64,"type":"ImageResize+","pos":[-1334.296875,642.6207885742188],"size":[270,218],"flags":{},"order":16,"mode":0,"inputs":[{"localized_name":"image","name":"image","type":"IMAGE","link":125},{"localized_name":"width","name":"width","type":"INT","widget":{"name":"width"},"link":null},{"localized_name":"height","name":"height","type":"INT","widget":{"name":"height"},"link":null},{"localized_name":"interpolation","name":"interpolation","type":"COMBO","widget":{"name":"interpolation"},"link":null},{"localized_name":"method","name":"method","type":"COMBO","widget":{"name":"method"},"link":null},{"localized_name":"condition","name":"condition","type":"COMBO","widget":{"name":"condition"},"link":null},{"localized_name":"multiple_of","name":"multiple_of","type":"INT","widget":{"name":"multiple_of"},"link":null}],"outputs":[{"localized_name":"图像","name":"IMAGE","type":"IMAGE","links":[118]},{"localized_name":"width","name":"width","type":"INT","links":[137]},{"localized_name":"height","name":"height","type":"INT","links":[138]}],"properties":{"cnr_id":"comfyui_essentials","ver":"1.1.0","Node name for S&R":"ImageResize+","widget_ue_connectable":{}},"widgets_values":[480,848,"nearest-exact","fill / crop","always",0]},{"id":83,"type":"VHS_LoadVideo","pos":[-1621.7362060546875,689.0585327148438],"size":[253.279296875,736.4938354492188],"flags":{},"order":12,"mode":0,"inputs":[{"localized_name":"meta_batch","name":"meta_batch","shape":7,"type":"VHS_BatchManager","link":null},{"localized_name":"vae","name":"vae","shape":7,"type":"VAE","link":null},{"localized_name":"video","name":"video","type":"COMBO","widget":{"name":"video"},"link":null},{"localized_name":"force_rate","name":"force_rate","type":"FLOAT","widget":{"name":"force_rate"},"link":null},{"localized_name":"custom_width","name":"custom_width","type":"INT","widget":{"name":"custom_width"},"link":null},{"localized_name":"custom_height","name":"custom_height","type":"INT","widget":{"name":"custom_height"},"link":null},{"localized_name":"frame_load_cap","name":"frame_load_cap","type":"INT","widget":{"name":"frame_load_cap"},"link":null},{"localized_name":"skip_first_frames","name":"skip_first_frames","type":"INT","widget":{"name":"skip_first_frames"},"link":null},{"localized_name":"select_every_nth","name":"select_every_nth","type":"INT","widget":{"name":"select_every_nth"},"link":null},{"localized_name":"format","name":"format","shape":7,"type":"COMBO","widget":{"name":"format"},"link":null}],"outputs":[{"localized_name":"图像","name":"IMAGE","type":"IMAGE","links":[125]},{"localized_name":"frame_count","name":"frame_count","type":"INT","links":null},{"localized_name":"audio","name":"audio","type":"AUDIO","links":null},{"localized_name":"video_info","name":"video_info","type":"VHS_VIDEOINFO","links":null}],"properties":{"cnr_id":"comfyui-videohelpersuite","ver":"1.6.1","Node name for S&R":"VHS_LoadVideo","widget_ue_connectable":{}},"widgets_values":{"video":"259abb73-1358-4775-8e26-0b21c2372975.mp4","force_rate":14,"custom_width":480,"custom_height":848,"frame_load_cap":41,"skip_first_frames":0,"select_every_nth":1,"format":"Wan","choose video to upload":"image","videopreview":{"hidden":false,"paused":false,"params":{"filename":"259abb73-1358-4775-8e26-0b21c2372975.mp4","type":"input","format":"video/mp4","force_rate":14,"custom_width":480,"custom_height":848,"frame_load_cap":41,"skip_first_frames":0,"select_every_nth":1}}}},{"id":84,"type":"LoadImage","pos":[-1889.42626953125,677.7117919921875],"size":[274.080078125,314.00006103515625],"flags":{},"order":13,"mode":0,"inputs":[{"localized_name":"图像","name":"image","type":"COMBO","widget":{"name":"image"},"link":null},{"localized_name":"选择文件上传","name":"upload","type":"IMAGEUPLOAD","widget":{"name":"upload"},"link":null}],"outputs":[{"localized_name":"图像","name":"IMAGE","type":"IMAGE","links":[136]},{"localized_name":"遮罩","name":"MASK","type":"MASK","links":null}],"properties":{"cnr_id":"comfy-core","ver":"0.3.34","Node name for S&R":"LoadImage","widget_ue_connectable":{}},"widgets_values":["ComfyUI_00071_.png","image"]},{"id":91,"type":"UnetLoaderGGUFDisTorchMultiGPU","pos":[-2274.153076171875,-223.62730407714844],"size":[327.8580017089844,154],"flags":{},"order":14,"mode":4,"inputs":[{"localized_name":"unet_name","name":"unet_name","type":"COMBO","widget":{"name":"unet_name"},"link":null},{"localized_name":"device","name":"device","shape":7,"type":"COMBO","widget":{"name":"device"},"link":null},{"localized_name":"virtual_vram_gb","name":"virtual_vram_gb","shape":7,"type":"FLOAT","widget":{"name":"virtual_vram_gb"},"link":null},{"localized_name":"use_other_vram","name":"use_other_vram","shape":7,"type":"BOOLEAN","widget":{"name":"use_other_vram"},"link":null},{"localized_name":"expert_mode_allocations","name":"expert_mode_allocations","shape":7,"type":"STRING","widget":{"name":"expert_mode_allocations"},"link":null}],"outputs":[{"localized_name":"模型","name":"MODEL","type":"MODEL","links":[124]}],"properties":{"cnr_id":"comfyui-multigpu","ver":"a05823ff0a5296332ae478b18ab93b46cd996a44","Node name for S&R":"UnetLoaderGGUFDisTorchMultiGPU","widget_ue_connectable":{}},"widgets_values":["Wan2.1_T2V_14B_FusionX_VACE-Q8_0.gguf","cuda:0",16,true,""]},{"id":70,"type":"PathchSageAttentionKJ","pos":[-1789.57958984375,-133.4229736328125],"size":[270,58],"flags":{},"order":19,"mode":0,"inputs":[{"localized_name":"model","name":"model","type":"MODEL","link":127},{"localized_name":"sage_attention","name":"sage_attention","type":"COMBO","widget":{"name":"sage_attention"},"link":null}],"outputs":[{"localized_name":"模型","name":"MODEL","type":"MODEL","links":[126]}],"properties":{"cnr_id":"comfyui-kjnodes","ver":"5dcda71011870278c35d92ff77a677ed2e538f2d","Node name for S&R":"PathchSageAttentionKJ","widget_ue_connectable":{}},"widgets_values":["auto"]},{"id":81,"type":"UnetLoaderGGUF","pos":[-2239.208740234375,-417.0163269042969],"size":[270,58],"flags":{},"order":15,"mode":0,"inputs":[{"localized_name":"unet_name","name":"unet_name","type":"COMBO","widget":{"name":"unet_name"},"link":null}],"outputs":[{"localized_name":"模型","name":"MODEL","type":"MODEL","links":[123]}],"properties":{"cnr_id":"comfyui-gguf","ver":"6570efec6992015085f11b84e42d32f6cc71e8b7","Node name for S&R":"UnetLoaderGGUF","widget_ue_connectable":{}},"widgets_values":["Wan2.1_14B_VACE-Q8_0.gguf"]},{"id":92,"type":"Power Lora Loader (rgthree)","pos":[-1900.1646728515625,22.563159942626953],"size":[324.8211669921875,166],"flags":{},"order":22,"mode":0,"inputs":[{"dir":3,"name":"model","type":"MODEL","link":147},{"dir":3,"name":"clip","type":"CLIP","link":148}],"outputs":[{"dir":4,"name":"MODEL","shape":3,"type":"MODEL","links":[130]},{"dir":4,"name":"CLIP","shape":3,"type":"CLIP","links":[144,145]}],"properties":{"cnr_id":"rgthree-comfy","ver":"6c5f7c95ed8487fe08e42bd0341cae6dc9c0f0ad","Show Strengths":"Single Strength","widget_ue_connectable":{}},"widgets_values":[{},{"type":"PowerLoraLoaderHeaderWidget"},{"on":true,"lora":"Wan21_CausVid_14B_T2V_lora_rank32.safetensors","strength":0.25,"strengthTwo":null},{},""]},{"id":85,"type":"WanVaceToVideo","pos":[-1046.0511474609375,225.20909118652344],"size":[315,254],"flags":{},"order":28,"mode":0,"inputs":[{"localized_name":"正向","name":"positive","type":"CONDITIONING","link":132},{"localized_name":"负向","name":"negative","type":"CONDITIONING","link":133},{"localized_name":"vae","name":"vae","type":"VAE","link":134},{"localized_name":"控制视频","name":"control_video","shape":7,"type":"IMAGE","link":149},{"localized_name":"控制mask","name":"control_masks","shape":7,"type":"MASK","link":null},{"localized_name":"参考图像","name":"reference_image","shape":7,"type":"IMAGE","link":136},{"localized_name":"宽度","name":"width","type":"INT","widget":{"name":"width"},"link":137},{"localized_name":"高度","name":"height","type":"INT","widget":{"name":"height"},"link":138},{"localized_name":"长度","name":"length","type":"INT","widget":{"name":"length"},"link":null},{"localized_name":"批量大小","name":"batch_size","type":"INT","widget":{"name":"batch_size"},"link":null},{"localized_name":"强度","name":"strength","type":"FLOAT","widget":{"name":"strength"},"link":null}],"outputs":[{"localized_name":"正向","name":"positive","type":"CONDITIONING","links":[140]},{"localized_name":"负向","name":"negative","type":"CONDITIONING","links":[141]},{"localized_name":"latent","name":"latent","type":"LATENT","links":[142]},{"localized_name":"裁剪latent","name":"trim_latent","type":"INT","links":[120]}],"properties":{"cnr_id":"comfy-core","ver":"0.3.34","Node name for S&R":"WanVaceToVideo","widget_ue_connectable":{}},"widgets_values":[720,720,41,1,1]},{"id":90,"type":"CLIPTextEncode","pos":[-1472.7308349609375,166.89588928222656],"size":[422.84503173828125,164.31304931640625],"flags":{},"order":27,"mode":0,"inputs":[{"localized_name":"clip","name":"clip","type":"CLIP","link":146},{"localized_name":"文本","name":"text","type":"STRING","widget":{"name":"text"},"link":null}],"outputs":[{"localized_name":"条件","name":"CONDITIONING","type":"CONDITIONING","slot_index":0,"links":[132]}],"title":"CLIP Text Encode (Positive Prompt)","properties":{"cnr_id":"comfy-core","ver":"0.3.34","Node name for S&R":"CLIPTextEncode","widget_ue_connectable":{}},"widgets_values":[""],"color":"#232","bgcolor":"#353"},{"id":59,"type":"Canny","pos":[-1041.200927734375,694.2437744140625],"size":[270,82],"flags":{},"order":18,"mode":0,"inputs":[{"localized_name":"图像","name":"image","type":"IMAGE","link":118},{"localized_name":"低阈值","name":"low_threshold","type":"FLOAT","widget":{"name":"low_threshold"},"link":null},{"localized_name":"高阈值","name":"high_threshold","type":"FLOAT","widget":{"name":"high_threshold"},"link":null}],"outputs":[{"localized_name":"图像","name":"IMAGE","type":"IMAGE","links":[129,149]}],"properties":{"cnr_id":"comfy-core","ver":"0.3.34","Node name for S&R":"Canny","widget_ue_connectable":{}},"widgets_values":[0.4,0.8]}],"links":[[117,62,0,58,0,"IMAGE"],[118,64,0,59,0,"IMAGE"],[119,86,0,60,0,"LATENT"],[120,85,3,60,1,"INT"],[121,60,0,62,0,"LATENT"],[122,67,0,62,1,"VAE"],[123,81,0,63,0,"MODEL"],[124,91,0,63,1,"MODEL"],[125,83,0,64,0,"IMAGE"],[126,70,0,69,0,"MODEL"],[127,63,0,70,0,"MODEL"],[128,88,0,75,0,"CLIP"],[129,59,0,76,0,"IMAGE"],[130,92,0,79,0,"MODEL"],[131,62,0,80,0,"IMAGE"],[132,90,0,85,0,"CONDITIONING"],[133,75,0,85,1,"CONDITIONING"],[134,67,0,85,2,"VAE"],[136,84,0,85,5,"IMAGE"],[137,64,1,85,6,"INT"],[138,64,2,85,7,"INT"],[139,79,0,86,0,"MODEL"],[140,85,0,86,1,"CONDITIONING"],[141,85,1,86,2,"CONDITIONING"],[142,85,2,86,3,"LATENT"],[143,80,0,87,0,"*"],[144,92,1,88,0,"*"],[145,92,1,89,0,"*"],[146,89,0,90,0,"CLIP"],[147,69,0,92,0,"MODEL"],[148,66,0,92,1,"CLIP"],[149,59,0,85,3,"IMAGE"]],"groups":[{"id":1,"title":"Load models here","bounding":[-1929.0147705078125,-45.6599006652832,410,620],"color":"#3f789e","font_size":24,"flags":{}},{"id":2,"title":"Prompt","bounding":[-1476.8291015625,76.2753677368164,450,470],"color":"#3f789e","font_size":24,"flags":{}},{"id":3,"title":"Sampling & Decoding","bounding":[-1021.2499389648438,121.46104431152344,730,470],"color":"#3f789e","font_size":24,"flags":{}},{"id":4,"title":"Save Video(Mp4)","bounding":[-280.864013671875,108.96293640136719,720,900],"color":"#3f789e","font_size":24,"flags":{}},{"id":5,"title":"Save Video(WebP)","bounding":[459.135986328125,108.96293640136719,700,900],"color":"#3f789e","font_size":24,"flags":{}},{"id":6,"title":"Load control video","bounding":[-1613.7481689453125,579.7350463867188,560,410],"color":"#3f789e","font_size":24,"flags":{}},{"id":7,"title":"Load reference image","bounding":[-1930.864013671875,598.9629516601562,300,410],"color":"#3f789e","font_size":24,"flags":{}},{"id":8,"title":"Image preprocessing","bounding":[-1040.9765625,614.8538208007812,730,410],"color":"#3f789e","font_size":24,"flags":{}},{"id":9,"title":"Low Vram high ram","bounding":[-2284.4716796875,-299.4523010253906,347.9408874511719,240.64456176757812],"color":"#a1309b","font_size":24,"flags":{}},{"id":10,"title":"Normal GGUF loader","bounding":[-2285.282470703125,-538.5192260742188,348.7563781738281,234.12091064453125],"color":"#a1309b","font_size":24,"flags":{}}],"config":{},"extra":{"ds":{"scale":0.6588450000000021,"offset":[2515.710772297133,266.65350846397206]},"frontendVersion":"1.16.8","VHS_latentpreview":false,"VHS_latentpreviewrate":0,"VHS_MetadataImage":true,"VHS_KeepIntermediate":true},"version":0.4}